<body id=b style=margin:0>
<canvas id=a width=522 height=256>
<script>
c = a.getContext`2d`;
d = document;
b = d.body;

g=(e,f)=>{for(i=0;i<n;i++){j=0;h=i;for(k=n;k>>=1;h>>=1)j=j<<1|h&1;j>i&&([e[j],e[i],f[j],f[i]]=[e[i],e[j],f[i],f[j]])}for(h=1;2*h<=n;h*=2)for(i=0;i<n;i+=2*h)for(j=i;j<i+h;j++)k=3.14*(j-i)/h,l=Math.cos(k),m=Math.sin(k),o=e[j+h]*l+f[j+h]*m,p=-e[j+h]*m+f[j+h]*l,e[j+h]=e[j]-o,f[j+h]=f[j]-p,e[j]+=o,f[j]+=p};q=(e,f)=>{Z=c.getImageData(0,0,n,n);d=Z.data;r=[];s=[];u=[];for(I=t=0;I<n;I++){r[I]=[];s[I]=[];for(J=0;J<n;J++)r[I][J]=d[4*(I*n+J)],s[I][J]=0;g(r[I],s[I])}v=[];w=[];for(I=0;I<n/2;I++){v[I]=v[n-I]=[];w[I]=w[n-I]=[];for(J=0;J<n;J++)v[I][J]=r[J][I],w[I][J]=s[J][I];g(v[I],w[I]);u[I]=u[n-I]=[];for(J=0;J<n;J++)u[I][J]=Math.hypot(v[I][J],w[I][J]),t=Math.max(t,u[I][J])}E=Math.log(t);for(I=0;I<n/2;I++)for(J=0;J<n/2;J++)z=4*(I*n+J),A=4*(I*n+n-J-1),B=4*((n-I-1)*n+J),C=4*((n-I-1)*n+n-J-1),u[n/2-I]&&(d[z]=d[z+1]=d[z+2]=d[A]=d[A+1]=d[A+2]=d[B]=d[B+1]=d[B+2]=d[C]=d[C+1]=d[C+2]=u[n/2-I][n/2-J]/E),d[z+3]=d[A+3]=d[B+3]=d[C+3]=n;c.putImageData(Z,n+9,0)};b.style.padding=`1em`;a.insertAdjacentHTML(`afterEnd`,`<p><input type=range value=9 id=G><input type=reset onmouseup=c.fillRect(0,0,n,n);q()>`);c.fillRect(0,0,n=256,n);q();x=y=F=0;a.onmousedown=(e,f)=>{c.lineWidth=+G.value+1;c.lineCap=e.which<2?`round`:`square`;c.strokeStyle=`#fff`;c.beginPath();c.moveTo(x=e.pageX-14,y=e.pageY-18);c.lineTo(x+1,y);c.stroke();q()};a.onmousemove=(e,f)=>x&&(c.moveTo(x,y),c.lineTo(x=e.pageX-14,y=e.pageY-18),c.stroke(),q());a.onmouseup=(e,f)=>x=y=0;oncontextmenu=(e,f)=>e.preventDefault()

</script>