<body id=b style=margin:0>
<canvas id=a width=522 height=256></canvas>

<script>
c = a.getContext`2d`;
d = document;
b = d.body;

d.write`<p><input type=range value=9 id=x><input type=reset onmouseup=c.fillStyle='#000';c.fillRect(0,0,n,n);q()>`;g=(e,f)=>{for(i=0;i<n;i++){j=0;h=i;for(k=n;k>>=1;h>>=1)j=j<<1|h&1;j>i&&([e[j],e[i],f[j],f[i]]=[e[i],e[j],f[i],f[j]])}for(h=1;2*h<=n;h*=2)for(i=0;i<n;i+=2*h)for(j=i;j<i+h;j++)k=3.14*(j-i)/h,l=Math.cos(k),m=Math.sin(k),o=e[j+h]*l+f[j+h]*m,p=-e[j+h]*m+f[j+h]*l,e[j+h]=e[j]-o,f[j+h]=f[j]-p,e[j]+=o,f[j]+=p};q=(e,f)=>{Z=c.getImageData(0,0,n,n);d=Z.data;r=[];s=[];u=[];for(I=t=0;I<n;I++){r[I]=[];s[I]=[];for(J=0;J<n;J++)r[I][J]=d[4*(I*n+J)],s[I][J]=0;g(r[I],s[I])}v=[];w=[];for(I=0;I<n/2;I++){v[I]=v[n-I]=[];w[I]=w[n-I]=[];for(J=0;J<n;J++)v[I][J]=r[J][I],w[I][J]=s[J][I];g(v[I],w[I]);u[I]=u[n-I]=[];for(J=0;J<n;J++)u[I][J]=Math.hypot(v[I][J],w[I][J]),t=Math.max(t,u[I][J])}E=Math.log(t);for(I=0;I<n/2;I++)for(J=0;J<n/2;J++)z=4*(I*n+J),A=4*(I*n+n-J-1),B=4*((n-I-1)*n+J),C=4*((n-I-1)*n+n-J-1),u[n/2-I]&&(d[z]=d[z+1]=d[z+2]=d[A]=d[A+1]=d[A+2]=d[B]=d[B+1]=d[B+2]=d[C]=d[C+1]=d[C+2]=u[n/2-I][n/2-J]/E),d[z+3]=d[A+3]=d[B+3]=d[C+3]=n;c.putImageData(Z,n+9,0)};c.fillRect(0,0,n=256,n);c.fillStyle='#fff';c.fillRect(120,120,16,16);q();X=Y=F=0;a.onmousedown=a.onmousemove=(e,f)=>{e.buttons?(c.lineWidth=+x.value+1,F=F||e.which,c.lineCap=e.altKey?`square`:`round`,c.strokeStyle=F<3?'#fff':'#000',c.lineTo(X,Y),c.lineTo(X=e.pageX,Y=e.pageY+1),c.stroke(),q()):(c.beginPath(),X=e.pageX,Y=e.pageY+1,F=0)};oncontextmenu=(e,f)=>e.preventDefault()

document.write("<p>&nbsp;Left click to draw in white, right click to draw in black, press Alt key to change the shape")
</script>